<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Drawing App</title>
</head>
<body>
<div id="container">
    <svg
            id="chart"
            xmlns="http://www.w3.org/2000/svg"

            width="600"
            height="600"

            viewBox="0 0 600 600"
    >
        <defs>
            <style>
              body{
                margin: 0;
              }

              #chart {
                user-select: none;
                cursor: crosshair;
                margin: 0 auto;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
                display: block;
              }

              #top-bar text {
                font-family: Arial, Helvetica, sans-serif;
                fill: #888;
              }

              .drawing-control {
                cursor: pointer;
                transition: transform 0.2s ease;
              }

              .drawing-control.active {
                transform: scale(1.3);
              }

              @media (min-width: 600px) {
                #chart{
                  width: 100vw;
                  height: 100vw;
                }
              }
            </style>
            <!-- no color pattern -->
            <pattern
                    id="no-color"
                    viewBox="0 0 20 20"
                    width="100%"
                    height="100%"
                    patternUnits="objectBoundingBox"
            >
                <rect
                        x="0"
                        y="0"
                        width="20"
                        height="20"
                        fill="white"
                />
                <line
                        x1="0"
                        y1="0"
                        x2="20"
                        y2="20"
                        stroke="red"
                        stroke-width="1"
                />
            </pattern>
            <!-- line width patterns -->
            <pattern
                    id="small-line-width"
                    viewBox="0 0 20 20"
                    width="100%"
                    height="100%"
                    patternUnits="objectBoundingBox"
            >
                <rect
                        x="0"
                        y="0"
                        width="20"
                        height="20"
                        fill="white"
                />
                <line
                        x1="0"
                        y1="10"
                        x2="20"
                        y2="10"
                        stroke="#222"
                        stroke-width="1"
                />
            </pattern>

            <pattern
                    id="mid-line-width"
                    viewBox="0 0 20 20"
                    width="100%"
                    height="100%"
                    patternUnits="objectBoundingBox"
            >
                <rect
                        x="0"
                        y="0"
                        width="20"
                        height="20"
                        fill="white"
                />
                <line
                        x1="0"
                        y1="10"
                        x2="20"
                        y2="10"
                        stroke="#222"
                        stroke-width="3"
                />
            </pattern>

            <pattern
                    id="big-line-width"
                    viewBox="0 0 20 20"
                    width="100%"
                    height="100%"
                    patternUnits="objectBoundingBox"
            >
                <rect
                        x="0"
                        y="0"
                        width="20"
                        height="20"
                        fill="white"
                />
                <line
                        x1="0"
                        y1="10"
                        x2="20"
                        y2="10"
                        stroke="#222"
                        stroke-width="6"
                />
            </pattern>

            <pattern
                    id="really-big-line-width"
                    viewBox="0 0 20 20"
                    width="100%"
                    height="100%"
                    patternUnits="objectBoundingBox"
            >
                <rect
                        x="0"
                        y="0"
                        width="20"
                        height="20"
                        fill="white"
                />
                <line
                        x1="0"
                        y1="10"
                        x2="20"
                        y2="10"
                        stroke="#222"
                        stroke-width="9"
                />
            </pattern>
        </defs>
        <g
                id="drawing-surface"
        >
            <!-- drawings go here -->
        </g>
        <g id="top-bar">
            <!-- fill controls -->
            <text x="10" y="36">Fill:</text>
            <rect
                    class="drawing-control active"
                    data-control-for="fill"
                    data-value="transparent"
                    x="45"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="55 30"
                    rx="3"
                    fill="url(#no-color)"
                    stroke="red"
            />
            <rect
                    class="drawing-control"
                    data-control-for="fill"
                    data-value="#e67e22"
                    x="75"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="85 30"
                    rx="3"
                    fill="#e67e22"
                    stroke="#e67e22"
            />
            <rect
                    class="drawing-control"
                    data-control-for="fill"
                    data-value="#e74c3c"
                    x="105"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="115 30"
                    rx="3"
                    fill="#e74c3c"
                    stroke="#e74c3c"
            />
            <rect
                    class="drawing-control"
                    data-control-for="fill"
                    data-value="#2980b9"
                    x="135"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="145 30"
                    rx="3"
                    fill="#2980b9"
                    stroke="#2980b9"
            />
            <!-- stroke controls -->
            <text
                    x="170"
                    y="36"
            >
                Stroke:
            </text>
            <rect
                    class="drawing-control"
                    data-control-for="stroke"
                    data-value="transparent"
                    x="230"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="240 30"
                    rx="3"
                    fill="url(#no-color)"
                    stroke="red"
            />
            <rect
                    class="drawing-control"
                    data-control-for="stroke"
                    data-value="#e67e22"
                    x="260"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="270 30"
                    rx="3"
                    fill="#e67e22"
                    stroke="#e67e22"
            />
            <rect
                    class="drawing-control"
                    data-control-for="stroke"
                    data-value="#e74c3c"
                    x="290"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="300 30"
                    rx="3"
                    fill="#e74c3c"
                    stroke="#e74c3c"
            />
            <rect
                    class="drawing-control active"
                    data-control-for="stroke"
                    data-value="#2980b9"
                    x="320"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="330 30"
                    rx="3"
                    fill="#2980b9"
                    stroke="#2980b9"
            />
            <!-- line width controls -->
            <text
                    x="355"
                    y="36"
            >
                Line Width:
            </text>
            <rect
                    class="drawing-control active"
                    data-control-for="line-width"
                    data-value="1"
                    x="445"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="455 30"
                    rx="3"
                    fill="url(#small-line-width)"
                    stroke="#aaa"
            />
            <rect
                    class="drawing-control"
                    data-control-for="line-width"
                    data-value="3"
                    x="475"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="485 30"
                    rx="3"
                    fill="url(#mid-line-width)"
                    stroke="#aaa"
            />

            <rect
                    class="drawing-control"
                    data-control-for="line-width"
                    data-value="6"
                    x="505"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="515 30"
                    rx="3"
                    fill="url(#big-line-width)"
                    stroke="#aaa"
            />

            <rect
                    class="drawing-control"
                    data-control-for="line-width"
                    data-value="9"
                    x="535"
                    y="20"
                    width="20"
                    height="20"
                    transform-origin="545 30"
                    rx="3"
                    fill="url(#really-big-line-width)"
                    stroke="#aaa"
                    stroke-linejoin="round"
                    stroke-linecap="round"
            />

        </g>
    </svg>
    <script>
      const STATE = {
        fill: 'transparent',
        stroke: 'blue',
        strokeWidth: 1
      }

      const SVG_NAMESPACE = 'http://www.w3.org/2000/svg'

      const svg = document.getElementById('chart')
      let svgDimensions = svg.getBoundingClientRect()
      let svgOffsetTop = svgDimensions.top
      let svgOffsetLeft = svgDimensions.left
      svg.setAttribute('width', `${svg.clientWidth}`)
      svg.setAttribute('height', `${svg.clientHeight}`)
      svg.setAttribute('viewBox', `0 0 ${svg.clientWidth} ${svg.clientHeight}`)

      window.addEventListener('resize', () => {
        svgDimensions = svg.getBoundingClientRect()
        svgOffsetTop = svgDimensions.top
        svgOffsetLeft = svgDimensions.left

        svg.setAttribute('width', `${svg.clientWidth}`)
        svg.setAttribute('height', `${svg.clientHeight}`)
        svg.setAttribute('viewBox', `0 0 ${svg.clientWidth} ${svg.clientHeight}`)

      })

      const fillColorControls = document.querySelectorAll('[data-control-for="fill"]')
      const strokeColorControls = document.querySelectorAll('[data-control-for="stroke"]')
      const lineWidthControls = document.querySelectorAll('[data-control-for="line-width"]')
      const drawingSurfaceEl = document.getElementById('drawing-surface')

      let isMouseDown = false
      let currentPath = null;

      const startDrawing = (e) => {
        if (e.target.classList.contains('drawing-control')) {
          return null
        }

        isMouseDown = true

        currentPath = document.createElementNS(SVG_NAMESPACE, 'path');
        currentPath.setAttribute('stroke', STATE.stroke);
        currentPath.setAttribute('stroke-width', STATE.strokeWidth);
        currentPath.setAttribute('fill', STATE.fill);
        currentPath.setAttribute('stroke-linejoin', 'round')
        currentPath.setAttribute('stroke-linecap', 'round')

        drawingSurfaceEl.appendChild(currentPath)
      }

      svg.addEventListener('mousedown', startDrawing)
      svg.addEventListener('touchstart', startDrawing)

      const makeDrawing = (e) => {
        if (!isMouseDown) {
          return null
        }


        let x, y;
        if(e.pageX){
          x = e.pageX - svgOffsetLeft
          y = e.pageY - svgOffsetTop
        }else{
          x = e.touches[0].pageX - svgOffsetLeft
          y = e.touches[0].pageY - svgOffsetTop
        }

        let newD = currentPath.getAttribute('d');

        if (!newD) {
          newD = `M ${x} ${y} `
        } else {
          newD += `L ${x} ${y}`
        }

        currentPath.setAttribute('d', newD)
      }

      svg.addEventListener('mousemove', makeDrawing)
      svg.addEventListener('touchmove', makeDrawing)

      const finishDrawing = (e) => {
        isMouseDown = false
      }

      svg.addEventListener('mouseup', finishDrawing)
      svg.addEventListener('touchend', finishDrawing)

      fillColorControls.forEach(control => {
        control.addEventListener('click', () => {
          svg.querySelector('.active[data-control-for="fill"]').classList.remove('active')
          control.classList.add('active')
          STATE.fill = control.dataset.value;
        })
      })

      strokeColorControls.forEach(control => {
        control.addEventListener('click', () => {
          svg.querySelector('.active[data-control-for="stroke"]').classList.remove('active')
          control.classList.add('active')
          STATE.stroke = control.dataset.value;
        })
      })

      lineWidthControls.forEach(control => {
        control.addEventListener('click', () => {
          svg.querySelector('.active[data-control-for="line-width"]').classList.remove('active')
          control.classList.add('active')
          STATE.strokeWidth = control.dataset.value;
        })
      })
    </script>
</div>
</body>
</html>